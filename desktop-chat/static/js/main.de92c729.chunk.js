(this["webpackJsonpweb-chat"]=this["webpackJsonpweb-chat"]||[]).push([[0],{53:function(e,a,t){e.exports=t(82)},78:function(e,a,t){},82:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(12),l=t.n(r),i=t(1);function s(e){return{type:"messages/searchRequest/start",payload:e}}function o(e){return{type:"contacts/searchRequest/start",payload:e}}var m=function(){var e=Object(i.b)(),a=Object(i.c)((function(e){return e.application.contactSearchValue}));return c.a.createElement("div",{className:"search-contact"},c.a.createElement("i",{className:"material-icons"},"search"),c.a.createElement("input",{placeholder:"Search Contact",value:a,onChange:function(a){e(o(a.target.value))}}),0!==a.length&&c.a.createElement("i",{onClick:function(){e(o(""))},className:"material-icons click"},"clear"))};var u=t(13),d=t.n(u);function f(e){var a=e.size,t=e.name,n=e.online,r=d()("avatar",{small:"small"===a},{medium:"medium"===a},{large:"large"===a});return c.a.createElement("div",{className:r},n&&c.a.createElement("div",{className:"online"}),c.a.createElement("div",{className:"m-auto"},t[0]))}f.defaultProps={name:"Name",size:"medium",online:!1};var p=f,v=t(2),E=t(31),h=t.n(E),b=t(46),g=function(){var e=document.getElementById("chat-window");e&&(e.scrollTop=e.scrollHeight)};function O(e,a){return function(t){t({type:"chat/load/started",payload:a}),fetch("https://api.intocode.ru:8001/api/messages/".concat(e,"/").concat(a)).then((function(e){return e.json()})).then((function(e){t({type:"chat/load/succeed",payload:e}),g()}))}}function j(e,a,t){return function(n,c){var r,l=c().chat.requestId;n((r={myId:e,requestId:l,content:t,toUserId:a,type:"text"},function(){var e=Object(b.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({type:"messages/send/started",payload:r});case 2:g();case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())),fetch("https://api.intocode.ru:8001/api/messages",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({myId:e,contactId:a,content:t,type:"text"})}).then((function(e){return e.json()})).then((function(e){n({type:"messages/send/succeed",payload:Object(v.a)({requestId:l},e)}),g()}))}}var N=function(e){var a=e.read;return c.a.createElement("span",{className:"read"},a?c.a.createElement("i",{className:"material-icons"},"done_all"):c.a.createElement("i",{className:"material-icons"},"done"))},y=t(15);var k=function(e){var a=e.children,t=e.type,n=e.isShow,r=d()("dropdown-menu",{"dropdown-contact":"contact"===t},{"dropdown-message":"message"===t});return n?c.a.createElement("div",{className:r},a):c.a.createElement("div",null)};var w=function(e){var a=e.action,t=e.children;return c.a.createElement("div",{onClick:a,className:"dropdown-item click"},t)},I=t(26);var C=function(){var e=Object(n.useState)(!1),a=Object(y.a)(e,2),t=a[0],r=a[1];return c.a.createElement(I.a,{onOutsideClick:function(){r(!1)}},c.a.createElement("span",{className:"option"},c.a.createElement("i",{className:"material-icons",onClick:function(e){e.stopPropagation(),r(!t)}},"more_horiz")),c.a.createElement(k,{type:"contact",isShow:t},c.a.createElement(w,null,"Delete"),c.a.createElement(w,null,"Archive")))},S=t(4),_=t(14),P=t.n(_);var q=function(e){var a=e.contact,t=a._id,n=a.fullname,r=a.lastMessage,l=a.online,s=Object(S.e)(),o=Object(i.b)(),m=Object(S.f)().id,u=Object(i.c)((function(e){return e.profile.myId})),f=d()("contact",{"active-contact":m===t});return c.a.createElement("div",{className:f,onClick:function(){t!==m&&(o(O(u,t)),s.push(t))}},c.a.createElement(p,{name:n,online:l}),c.a.createElement("div",{className:"info"},c.a.createElement("div",{className:"name"},n),c.a.createElement("div",{className:"last-message"},t===(null===r||void 0===r?void 0:r.toUserId)&&c.a.createElement(N,{read:r.read}),c.a.createElement("div",{className:"contact-content"},null===r||void 0===r?void 0:r.content))),c.a.createElement("div",{className:"options"},c.a.createElement("span",{className:"date-contact"},P()(null===r||void 0===r?void 0:r.time).format("hh:mm")),c.a.createElement(C,{contactId:t})))},x=t(36),M=t.n(x);function V(){return c.a.createElement("div",{className:"contact-skeleton"},c.a.createElement("div",{className:"avatar-skeleton"},c.a.createElement(M.a,{height:100,width:100})),c.a.createElement("div",{className:"info-skeleton"},c.a.createElement(M.a,{count:2})))}var U=function(){return new Array(9).fill(1).map((function(e,a){return c.a.createElement(V,{key:a})}))};var T=function(){var e=Object(i.b)();Object(n.useEffect)((function(){e((function(e){e({type:"contacts/load/started"}),fetch("https://api.intocode.ru:8001/api/contacts").then((function(e){return e.json()})).then((function(a){return e({type:"contacts/load/succeed",payload:a})}))}))}),[e]);var a=Object(i.c)((function(e){var a=e.application.contactSearchValue;return e.contacts.items.filter((function(e){return-1!==e.fullname.toUpperCase().indexOf(a.toUpperCase())}))})),t=Object(i.c)((function(e){return e.contacts.loading}));return c.a.createElement("div",{className:"sidebar"},c.a.createElement("div",{className:"search-parent"},c.a.createElement(m,null)),c.a.createElement("div",{className:"contacts-block"},t?c.a.createElement(U,null):a.map((function(e){return c.a.createElement(q,{key:e._id,contact:e})}))))},z=t(51),D=t(84),R=t(85);var A=function(e){var a=e.hasMessage,t=e.onSend;return c.a.createElement("button",{className:"send click"},c.a.createElement(D.a,null,c.a.createElement(R.a,{key:a,timeout:100,classNames:"sendIcon"},c.a.createElement("i",{className:"material-icons",onClick:t},a?"send":"mic"))))};var J=function(){return c.a.createElement("button",{className:"send click"},c.a.createElement("i",{className:"material-icons"},"attach_file"))},L=t(20);var B=function(){var e=Object(n.useState)(""),a=Object(y.a)(e,2),t=a[0],r=a[1],l=Object(i.b)(),s=Object(i.c)((function(e){return e.profile.myId})),o=Object(S.f)().id,m=Object(n.useCallback)((function(){0!==t.length&&(l(j(s,o,t)),u())}),[t,o,s]),u=function(){r("")};return Object(L.a)("shift+enter",(function(e){e.preventDefault(),r((function(e){return e+"\n"}))})),Object(L.a)("enter",(function(e){e.preventDefault(),m()}),[t]),c.a.createElement("div",{className:"form-block"},c.a.createElement(z.a,{onChange:function(e){r(e.target.value)},value:t,className:"send-form",placeholder:"Write a message...",maxRows:"5"}),c.a.createElement(J,null),c.a.createElement(A,{hasMessage:t.length>0,onSend:m}))};var H=function(){var e=Object(i.b)(),a=Object(i.c)((function(e){return e.application.searchValue})),t=Object(i.c)((function(e){return e.application.searchOpen}));return c.a.createElement("div",{className:t?"search-message":"search-message-close"},c.a.createElement("div",{className:"icon click",onClick:function(){e({type:"search/show/hide/toggle"})}},c.a.createElement("i",{className:"material-icons"},"search")),c.a.createElement("input",{value:a,onChange:function(a){e(s(a.target.value))}}),0!==a.length&&c.a.createElement("i",{onClick:function(){e(s(""))},className:"material-icons click"},"clear"))};var W=function(){return c.a.createElement("span",{className:"updating"},"Updating",c.a.createElement("i",{className:"material-icons loading-chat"},"autorenew"),"...")};function F(e){var a=e.name,t=e.online;return c.a.createElement("div",{className:"header-name"},c.a.createElement("div",{className:"name-info"},a,t&&c.a.createElement("div",{className:"online"})))}F.defaultProps={name:"Name Lastname",online:!1};var G=F;var K=function(){var e=Object(S.f)().id,a=Object(i.b)(),t=Object(i.c)((function(e){return e.chat.loading})),n=Object(i.c)((function(a){return a.contacts.items.find((function(a){return e===a._id}))}));return c.a.createElement("div",{className:"header-parent"},c.a.createElement("div",{className:"header-search"},c.a.createElement(H,null)),t?c.a.createElement(W,null):c.a.createElement(G,{name:null===n||void 0===n?void 0:n.fullname,online:null===n||void 0===n?void 0:n.online}),c.a.createElement("div",{className:"profile-open"},c.a.createElement("i",{className:"material-icons click",onClick:function(){a({type:"profile/open/toggle"})}},"person")))},Q=t(7),X=t.n(Q);var Y=function(e){var a=e.messageId,t=Object(i.b)(),r=Object(n.useState)(!1),l=Object(y.a)(r,2),s=l[0],o=l[1],m=d()("dropdown-icon-close",{"dropdown-icon":s});return c.a.createElement(I.a,{onOutsideClick:function(){o(!1)}},c.a.createElement("div",{className:m,onClick:function(){o(!s)}},c.a.createElement("i",{className:"material-icons"},"keyboard_arrow_down")),c.a.createElement(k,{type:"message",isShow:s},c.a.createElement(w,{action:function(){t(function(e){return function(a){a({type:"message/delete/started",payload:e}),fetch("https://api.intocode.ru:8001/api/messages",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return a({type:"message/delete/succeed",payload:e})}))}}(a))}},"Delete")))};var Z=function(e){var a=e.message;return c.a.createElement("div",{className:"my-message-block margin"},c.a.createElement("div",{className:"message"},a.content.split("\n").map((function(e,a){return c.a.createElement("div",{key:a},e,c.a.createElement("br",null))})),c.a.createElement("div",{className:"date"},c.a.createElement("div",null,P()(a.time).format("hh:mm")),a.sending?c.a.createElement("span",{className:"timer"},c.a.createElement("i",{className:"material-icons "},"timer")):c.a.createElement(N,{read:a.read})),c.a.createElement(Y,{messageId:a._id})))};var $=function(e){var a=e.message,t=Object(S.f)().id,n=Object(i.c)((function(e){return e.contacts.items.find((function(e){return t===e._id}))})).fullname;return c.a.createElement("div",{className:"message-block margin"},c.a.createElement(p,{size:"small",name:n&&n}),c.a.createElement("div",{className:"message"},a.content,c.a.createElement("div",{className:"date"},c.a.createElement("div",null,P()(a.time).format("hh:mm"))),c.a.createElement(Y,{messageId:a._id})))};function ee(e){var a=e.message;return Object(i.c)((function(e){return e.profile.myId}))===a.toUserId?c.a.createElement($,{message:a}):c.a.createElement(Z,{message:a})}ee.propType={message:X.a.object};var ae=ee;var te=function(e){var a=e.content;return c.a.createElement("div",{className:"type-info margin"},a)};var ne=function(e){var a=e.message;return"text"===a.type?c.a.createElement(ae,{message:a}):c.a.createElement(te,{content:a.content})};var ce=function(){return c.a.createElement("div",{className:"preloader"},c.a.createElement("div",null,"Please, select a chat to start messaging"))};var re=function(){var e=Object(i.b)(),a=Object(i.c)((function(e){return e.chat.items.filter((function(a){return-1!==a.content.toUpperCase().indexOf(e.application.searchValue.toUpperCase())}))})),t=Object(i.c)((function(e){return e.profile.myId})),r=Object(i.c)((function(e){return e.chat.loading})),l=Object(S.f)().id;return Object(n.useEffect)((function(){l&&e(O(t,l))}),[e,l,t]),l?c.a.createElement("div",{className:"chat-parent"},c.a.createElement(K,null),c.a.createElement("div",{className:"chat-block",id:"chat-window"},!r&&a.map((function(e,a){return c.a.createElement(ne,{key:a,message:e})}))),c.a.createElement("div",{className:"parent-form"},c.a.createElement(B,null))):c.a.createElement(ce,null)};var le=function(e){var a=e.socials;return c.a.createElement("div",{className:"profile-social"},c.a.createElement("span",{className:"header-profile"},"Social"),c.a.createElement("div",{className:"social-block"},a&&Object.keys(a).map((function(e,t){return c.a.createElement("div",{key:t,className:"icons-social click"},c.a.createElement("i",{className:"fab fa-".concat(e)})," ",a[e])}))))};function ie(e){var a=e.fileName;return c.a.createElement("div",{className:"profile-media"},c.a.createElement("span",{className:"header-profile"},"Media"),c.a.createElement("div",{className:"mediafiles"},c.a.createElement("div",{className:"file click"},c.a.createElement("div",{className:"media-img"}),c.a.createElement("div",{className:"media-info"},a))))}ie.defaultProps={fileName:"fileName"};var se=ie;var oe=function(){return c.a.createElement("div",{className:"communication"},c.a.createElement("div",{className:"icons click"},c.a.createElement("div",{className:"m-auto"},c.a.createElement("i",{className:"material-icons"},"call"))),c.a.createElement("div",{className:"icons click"},c.a.createElement("div",{className:"m-auto"},c.a.createElement("i",{className:"material-icons"},"videocam"))),c.a.createElement("div",{className:"icons click"},c.a.createElement("div",{className:"m-auto"},c.a.createElement("i",{className:"material-icons"},"mail"))))};var me=function(){var e=Object(i.b)(),a=Object(S.f)().id,t=Object(i.c)((function(e){return e.application.openContactProfile})),n=Object(i.c)((function(e){return e.contacts.items.find((function(e){return a===e._id}))})),r=Object(i.c)((function(e){return e.contacts.loading}));return Object(L.a)("shift+p",(function(){e({type:"profile/open/toggle"})}),{filter:function(){return!0}}),r||!a?null:c.a.createElement("div",{className:t?"profile-parent-open":"profile-parent"},c.a.createElement("div",{className:"profile-info"},c.a.createElement(p,{size:"large",name:null===n||void 0===n?void 0:n.fullname}),c.a.createElement("div",{className:"profile-name"},null===n||void 0===n?void 0:n.fullname),c.a.createElement("div",{className:"nickname"},"@",null===n||void 0===n?void 0:n.username),c.a.createElement(oe,null)),c.a.createElement(le,{socials:null===n||void 0===n?void 0:n.socials}),c.a.createElement(se,{fileName:"filename.pdf"}))},ue=t(11);var de=function(){var e=Object(i.b)();return Object(n.useEffect)((function(){e((function(e){e({type:"myProfile/load/started"}),fetch("https://api.intocode.ru:8001/api/profile").then((function(e){return e.json()})).then((function(a){return e({type:"myProfile/load/succeed",payload:a})}))}))}),[e]),!Object(i.c)((function(e){return e.profile.loadingMyId}))&&c.a.createElement(ue.a,null,c.a.createElement(S.a,{path:"/:id?"},c.a.createElement(T,null),c.a.createElement(re,null),c.a.createElement(me,null)))},fe=(t(78),t(79),t(80),t(81),t(49)),pe=t(16),ve=t(25),Ee={items:[],loading:!0,requestId:1,deleting:!1};var he={myId:"",loadingMyId:!0};var be={items:[],contactSearchValue:"",loading:!0};var ge=t(50),Oe={searchOpen:!1,searchValue:"",contactSearchValue:"",openContactProfile:!1};var je=Object(fe.createLogger)({collapsed:!0,diff:!0}),Ne=Object(pe.c)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"chat/load/started":return Object(v.a)(Object(v.a)({},e),{},{open:!0,loading:!0});case"chat/load/succeed":return Object(v.a)(Object(v.a)({},e),{},{items:a.payload,loading:!1});case"messages/send/started":var t=Object(v.a)(Object(v.a)({},a.payload),{},{sending:!0});return Object(v.a)(Object(v.a)({},e),{},{requestId:e.requestId+1,items:[].concat(Object(ve.a)(e.items),[t])});case"messages/send/succeed":return Object(v.a)(Object(v.a)({},e),{},{items:e.items.map((function(e){return e.requestId===a.payload.requestId?Object(v.a)(Object(v.a)({},e),{},{sending:!1,_id:a.payload._id}):e}))});case"message/delete/started":return Object(v.a)(Object(v.a)({},e),{},{items:e.items.filter((function(e){return e._id!==a.payload})),deleting:!0});case"message/delete/succeed":return Object(v.a)(Object(v.a)({},e),{},{items:a.payload,deleting:!1});default:return e}},profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"myProfile/load/started":return Object(v.a)(Object(v.a)({},e),{},{loadingMyId:!0});case"myProfile/load/succeed":return Object(v.a)(Object(v.a)({},e),{},{myId:a.payload._id,loadingMyId:!1});default:return e}},contacts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"contacts/load/started":return Object(v.a)(Object(v.a)({},e),{},{loading:!0});case"contacts/load/succeed":return Object(v.a)(Object(v.a)({},e),{},{items:a.payload,loading:!1});default:return e}},application:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"profile/open/toggle":return Object(v.a)(Object(v.a)({},e),{},{openContactProfile:!e.openContactProfile});case"search/show/hide/toggle":return Object(v.a)(Object(v.a)({},e),{},{searchOpen:!e.searchOpen});case"messages/searchRequest/start":return Object(v.a)(Object(v.a)({},e),{},{searchValue:a.payload});case"contacts/searchRequest/start":return Object(v.a)(Object(v.a)({},e),{},{contactSearchValue:a.payload});default:return e}}}),ye=Object(pe.d)(Ne,Object(pe.a)(ge.a,je));l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(i.a,{store:ye},c.a.createElement("div",{className:"container"},c.a.createElement(de,null)))),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.de92c729.chunk.js.map